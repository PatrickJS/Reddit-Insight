/**
 * Knob - jQuery Plugin
 * Downward compatible, touchable dial
 *
 * Version: 1.1.2 (22/05/2012)
 * Requires: jQuery v1.7+
 *
 * Copyright (c) 2011 Anthony Terrien
 * Under MIT and GPL licenses:
 *  http://www.opensource.org/licenses/mit-license.php
 *  http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to vor, eskimoblood, spiffistan
 */$(function(){function t(e){return $.isNumeric(e)?e*Math.PI/180:0}var e=function(t,n){var r=null,i=t[0].getContext("2d"),s=2*Math.PI,o,u,a,f,l=this;this.onChange=function(){};this.onCancel=function(){};this.onRelease=function(){};this.val=function(e){if(null==e){var t,i;t=i=Math.atan2(o-a,-(u-f-n.width/2))-n.angleOffset;i<0&&(t=i+s);e=Math.round(t*(n.max-n.min)/s)+n.min;return e>n.max?n.max:e}n.stopper&&(e=Math.max(Math.min(e,n.max),n.min));r=e;this.onChange(e);n.dynamicDraw?this.dynamicDraw(e):this.draw(e)};this.change=function(e){n.stopper&&(e=Math.max(Math.min(e,n.max),n.min));this.onChange(e);this.draw(e)};this.angle=function(e){return(e-n.min)*s/(n.max-n.min)};this.draw=function(t){var o=this.angle(t),u=1.5*Math.PI+n.angleOffset,a=u,f=u+this.angle(r),l=a+o,c=n.width/2,h=c*n.thickness,p=e.getCgColor(n.cgColor),d;i.clearRect(0,0,n.width,n.width);i.lineWidth=h;if(n.draw(o,r,n,i))return;for(d=0;d<n.ticks;d++){i.beginPath();o>2*Math.PI/n.ticks*d&&n.tickColorizeValues?i.strokeStyle=n.fgColor:i.strokeStyle=n.tickColor;var m=2*Math.PI/n.ticks*d-.5*Math.PI;i.arc(c,c,c-h-n.tickLength,m,m+n.tickWidth,!1);i.stroke()}n.cursor&&(u=f-.3)&&(f+=.3)&&(a=l-.3)&&(l+=.3);switch(n.skin){case"default":i.beginPath();i.strokeStyle=n.bgColor;i.arc(c,c,c-h/2,0,s,!0);i.stroke();if(n.displayPrevious){i.beginPath();i.strokeStyle=r==t?n.fgColor:p;i.arc(c,c,c-h/2,u,f,!1);i.stroke()}i.beginPath();i.strokeStyle=n.fgColor;i.arc(c,c,c-h/2,a,l,!1);i.stroke();break;case"tron":if(n.displayPrevious){i.beginPath();i.strokeStyle=r==t?n.fgColor:p;i.arc(c,c,c-h,u,f,!1);i.stroke()}i.beginPath();i.strokeStyle=n.fgColor;i.arc(c,c,c-h,a,l,!1);i.stroke();i.lineWidth=2;i.beginPath();i.strokeStyle=n.fgColor;i.arc(c,c,c-h+1+h*2/3,0,2*Math.PI,!1);i.stroke()}};var c,h;this.dynamicDraw=function(e){var t=this;c=n.min;h=setInterval(function(){t.animateDraw(e)},20)};this.animateDraw=function(){if(c>r){clearInterval(h);r=c}else{this.draw(c);this.change(c);c++}};this.capture=function(e){switch(e.type){case"mousemove":case"mousedown":o=e.pageX;u=e.pageY;break;case"touchmove":case"touchstart":o=e.originalEvent.touches[0].pageX;u=e.originalEvent.touches[0].pageY}this.change(this.val())};this.cancel=function(){l.val(r);l.onCancel()};this.startDrag=function(e){var i=t.offset(),s=$(document);a=i.left+n.width/2;f=i.top;this.capture(e);s.bind("mousemove.dial touchmove.dial",function(e){l.capture(e)}).bind("keyup.dial",function(e){if(e.keyCode===27){s.unbind("mouseup.dial mousemove.dial keyup.dial");l.cancel()}}).bind("mouseup.dial touchend.dial",function(e){s.unbind("mousemove.dial touchmove.dial mouseup.dial touchend.dial keyup.dial");l.val(l.val());l.onRelease(r)})}};e.getCgColor=function(e){e=e.substring(1,7);var t=[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)];return"rgba("+t[0]+","+t[1]+","+t[2]+",.5)"};$.fn.knob=$.fn.dial=function(n){return this.each(function(){var r=$(this),i;if(r.data("dialed"))return r;r.data("dialed",!0);i=$.extend({min:r.data("min")||0,max:r.data("max")||100,stopper:!0,readOnly:r.data("readonly"),cursor:r.data("cursor"),thickness:r.data("thickness")||.35,width:r.data("width")||200,displayInput:r.data("displayinput")==null||r.data("displayinput"),displayPrevious:r.data("displayprevious"),fgColor:r.data("fgcolor")||"#87CEEB",cgColor:r.data("cgcolor")||r.data("fgcolor")||"#87CEEB",bgColor:r.data("bgcolor")||"#EEEEEE",tickColor:r.data("tickColor")||r.data("fgcolor")||"#DDDDDD",ticks:r.data("ticks")||0,tickLength:r.data("tickLength")||0,tickWidth:r.data("tickWidth")||.02,tickColorizeValues:r.data("tickColorizeValues")||!0,skin:r.data("skin")||"default",angleOffset:t(r.data("angleoffset")),dynamicDraw:r.data("dynamicdraw")||!1,draw:function(e,t,n,r){},change:function(e){},release:function(e,t){}},n);var s=$('<canvas width="'+i.width+'" height="'+i.width+'"></canvas>'),o=$("<div style=width:"+i.width+'px;display:inline;"></div>'),u,a=r.val(),f=function(){i.displayInput&&r.css({width:i.width/2+"px",position:"absolute","margin-top":i.width*5/14+"px","margin-left":"-"+i.width*3/4+"px","font-size":i.width/4+"px",border:"none",background:"none","font-family":"Arial","font-weight":"bold","text-align":"center",color:i.fgColor,padding:"0px","-webkit-appearance":"none"})||r.css({width:"0px",visibility:"hidden"})};r.wrap(o).before(s);f();u=new e(s,i);a||(a=i.min);r.val(a);u.val(a);u.onRelease=function(e){i.release(e,r)};u.onChange=function(e){r.val(e);i.change(e)};r.bind("change",function(e){u.val(r.val())});if(!i.readOnly){s.bind("mousedown touchstart",function(e){e.preventDefault();u.startDrag(e)}).bind("mousewheel DOMMouseScroll",mw=function(e){e.preventDefault();var t=e.originalEvent,n=t.detail||t.wheelDeltaX,i=t.detail||t.wheelDeltaY,s=parseInt(r.val())+(n>0||i>0?1:n<0||i<0?-1:0);u.val(s)});var l,c,h,p=1,d={37:-1,38:1,39:1,40:-1};r.bind("configure",function(e,t){var n;for(n in t)i[n]=t[n];f();u.val(r.val())}).bind("keydown",function(e){var t=e.keyCode;t>=96&&t<=105&&(t-=48);l=parseInt(String.fromCharCode(t));if(isNaN(l)){t!==13&&t!==8&&t!==9&&t!==189&&e.preventDefault();if($.inArray(t,[37,38,39,40])>-1){u.change(parseInt(r.val())+d[t]*p);h=window.setTimeout(function(){p<20&&p++},50);e.preventDefault()}}}).bind("keyup",function(e){if(isNaN(l))if(h){window.clearTimeout(h);h=null;p=1;u.val(r.val());u.onRelease(r.val(),r)}else e.keyCode===13&&u.onRelease(r.val(),r);else r.val()>i.max&&r.val(i.max)||r.val()<i.min&&r.val(i.min)}).bind("mousewheel DOMMouseScroll",mw)}else r.attr("readonly","readonly")}).parent()}});